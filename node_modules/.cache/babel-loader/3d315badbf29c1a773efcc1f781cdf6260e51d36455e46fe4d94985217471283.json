{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React from 'react';\nimport { DndContext, DragOverlay } from '@dnd-kit/core';\nimport { arrayMove, SortableContext, verticalListSortingStrategy } from '@dnd-kit/sortable';\nimport { useInternalI18n } from '../../i18n/context';\nimport Portal from '../../internal/components/portal';\nimport { useUniqueId } from '../../internal/hooks/use-unique-id';\nimport ContentDisplayOption from './content-display-option';\nimport DraggableOption from './draggable-option';\nimport useDragAndDropReorder from './use-drag-and-drop-reorder';\nimport useLiveAnnouncements from './use-live-announcements';\nimport { getSortedOptions } from './utils';\nimport styles from '../styles.css.js';\nconst componentPrefix = 'content-display';\nconst getClassName = suffix => styles[`${componentPrefix}-${suffix}`];\nexport default function ContentDisplayPreference({\n  title,\n  description,\n  options,\n  value = options.map(({\n    id\n  }) => ({\n    id,\n    visible: true\n  })),\n  onChange,\n  liveAnnouncementDndStarted,\n  liveAnnouncementDndItemReordered,\n  liveAnnouncementDndItemCommitted,\n  liveAnnouncementDndDiscarded,\n  dragHandleAriaDescription,\n  dragHandleAriaLabel\n}) {\n  const idPrefix = useUniqueId(componentPrefix);\n  const i18n = useInternalI18n('collection-preferences');\n  const onToggle = option => {\n    onChange(value.map(item => item.id === option.id ? Object.assign(Object.assign({}, item), {\n      visible: !option.visible\n    }) : item));\n  };\n  const titleId = `${idPrefix}-title`;\n  const descriptionId = `${idPrefix}-description`;\n  const sortedOptions = getSortedOptions({\n    options,\n    contentDisplay: value\n  });\n  const {\n    activeItem,\n    collisionDetection,\n    handleKeyDown,\n    sensors,\n    setActiveItem\n  } = useDragAndDropReorder({\n    sortedOptions\n  });\n  const activeOption = activeItem ? sortedOptions.find(({\n    id\n  }) => id === activeItem) : null;\n  const announcements = useLiveAnnouncements({\n    isDragging: activeItem !== null,\n    liveAnnouncementDndStarted: i18n('contentDisplayPreference.liveAnnouncementDndStarted', liveAnnouncementDndStarted, format => (position, total) => format({\n      position,\n      total\n    })),\n    liveAnnouncementDndItemReordered: i18n('contentDisplayPreference.liveAnnouncementDndItemReordered', liveAnnouncementDndItemReordered, format => (initialPosition, currentPosition, total) => format({\n      currentPosition,\n      total,\n      isInitialPosition: `${initialPosition === currentPosition}`\n    })),\n    liveAnnouncementDndItemCommitted: i18n('contentDisplayPreference.liveAnnouncementDndItemCommitted', liveAnnouncementDndItemCommitted, format => (initialPosition, finalPosition, total) => format({\n      initialPosition,\n      finalPosition,\n      total,\n      isInitialPosition: `${initialPosition === finalPosition}`\n    })),\n    liveAnnouncementDndDiscarded: i18n('contentDisplayPreference.liveAnnouncementDndDiscarded', liveAnnouncementDndDiscarded),\n    sortedOptions: value\n  });\n  const renderedDragHandleAriaDescription = i18n('contentDisplayPreference.dragHandleAriaDescription', dragHandleAriaDescription);\n  return React.createElement(\"div\", {\n    className: styles[componentPrefix]\n  }, React.createElement(\"h3\", {\n    className: getClassName('title'),\n    id: titleId\n  }, i18n('contentDisplayPreference.title', title)), React.createElement(\"p\", {\n    className: getClassName('description'),\n    id: descriptionId\n  }, i18n('contentDisplayPreference.description', description)), React.createElement(DndContext, {\n    sensors: sensors,\n    collisionDetection: collisionDetection,\n    accessibility: {\n      announcements,\n      restoreFocus: false,\n      screenReaderInstructions: renderedDragHandleAriaDescription ? {\n        draggable: renderedDragHandleAriaDescription\n      } : undefined\n    },\n    onDragStart: ({\n      active\n    }) => setActiveItem(active.id),\n    onDragEnd: event => {\n      setActiveItem(null);\n      const {\n        active,\n        over\n      } = event;\n      if (over && active.id !== over.id) {\n        const oldIndex = value.findIndex(({\n          id\n        }) => id === active.id);\n        const newIndex = value.findIndex(({\n          id\n        }) => id === over.id);\n        onChange(arrayMove([...value], oldIndex, newIndex));\n      }\n    },\n    onDragCancel: () => setActiveItem(null)\n  }, React.createElement(\"ul\", {\n    className: getClassName('option-list'),\n    \"aria-describedby\": descriptionId,\n    \"aria-labelledby\": titleId,\n    role: \"list\"\n  }, React.createElement(SortableContext, {\n    items: sortedOptions.map(({\n      id\n    }) => id),\n    strategy: verticalListSortingStrategy\n  }, sortedOptions.map(option => {\n    return React.createElement(DraggableOption, {\n      dragHandleAriaLabel: i18n('contentDisplayPreference.dragHandleAriaLabel', dragHandleAriaLabel),\n      key: option.id,\n      onKeyDown: handleKeyDown,\n      onToggle: onToggle,\n      option: option\n    });\n  }))), React.createElement(Portal, null, React.createElement(DragOverlay, {\n    className: styles['drag-overlay'],\n    dropAnimation: null,\n    style: {\n      zIndex: 5000\n    }\n  }, activeOption && React.createElement(ContentDisplayOption, {\n    listeners: {\n      onKeyDown: handleKeyDown\n    },\n    dragHandleAriaLabel: i18n('contentDisplayPreference.dragHandleAriaLabel', dragHandleAriaLabel),\n    onToggle: onToggle,\n    option: activeOption\n  })))));\n}","map":{"version":3,"names":["React","DndContext","DragOverlay","arrayMove","SortableContext","verticalListSortingStrategy","useInternalI18n","Portal","useUniqueId","ContentDisplayOption","DraggableOption","useDragAndDropReorder","useLiveAnnouncements","getSortedOptions","styles","componentPrefix","getClassName","suffix","ContentDisplayPreference","title","description","options","value","map","id","visible","onChange","liveAnnouncementDndStarted","liveAnnouncementDndItemReordered","liveAnnouncementDndItemCommitted","liveAnnouncementDndDiscarded","dragHandleAriaDescription","dragHandleAriaLabel","idPrefix","i18n","onToggle","option","item","Object","assign","titleId","descriptionId","sortedOptions","contentDisplay","activeItem","collisionDetection","handleKeyDown","sensors","setActiveItem","activeOption","find","announcements","isDragging","format","position","total","initialPosition","currentPosition","isInitialPosition","finalPosition","renderedDragHandleAriaDescription","createElement","className","accessibility","restoreFocus","screenReaderInstructions","draggable","undefined","onDragStart","active","onDragEnd","event","over","oldIndex","findIndex","newIndex","onDragCancel","role","items","strategy","key","onKeyDown","dropAnimation","style","zIndex","listeners"],"sources":["/Users/dootano/Desktop/thetekshow-demo-app/node_modules/src/collection-preferences/content-display/index.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React from 'react';\nimport { DndContext, DragOverlay } from '@dnd-kit/core';\nimport { arrayMove, SortableContext, verticalListSortingStrategy } from '@dnd-kit/sortable';\n\nimport { useInternalI18n } from '../../i18n/context';\nimport Portal from '../../internal/components/portal';\nimport { useUniqueId } from '../../internal/hooks/use-unique-id';\nimport { CollectionPreferencesProps } from '../interfaces';\nimport ContentDisplayOption from './content-display-option';\nimport DraggableOption from './draggable-option';\nimport useDragAndDropReorder from './use-drag-and-drop-reorder';\nimport useLiveAnnouncements from './use-live-announcements';\nimport { getSortedOptions, OptionWithVisibility } from './utils';\n\nimport styles from '../styles.css.js';\n\nconst componentPrefix = 'content-display';\n\nconst getClassName = (suffix: string) => styles[`${componentPrefix}-${suffix}`];\n\ninterface ContentDisplayPreferenceProps extends CollectionPreferencesProps.ContentDisplayPreference {\n  onChange: (value: ReadonlyArray<CollectionPreferencesProps.ContentDisplayItem>) => void;\n  value?: ReadonlyArray<CollectionPreferencesProps.ContentDisplayItem>;\n}\n\nexport default function ContentDisplayPreference({\n  title,\n  description,\n  options,\n  value = options.map(({ id }) => ({\n    id,\n    visible: true,\n  })),\n  onChange,\n  liveAnnouncementDndStarted,\n  liveAnnouncementDndItemReordered,\n  liveAnnouncementDndItemCommitted,\n  liveAnnouncementDndDiscarded,\n  dragHandleAriaDescription,\n  dragHandleAriaLabel,\n}: ContentDisplayPreferenceProps) {\n  const idPrefix = useUniqueId(componentPrefix);\n  const i18n = useInternalI18n('collection-preferences');\n\n  const onToggle = (option: OptionWithVisibility) => {\n    onChange(value.map(item => (item.id === option.id ? { ...item, visible: !option.visible } : item)));\n  };\n\n  const titleId = `${idPrefix}-title`;\n  const descriptionId = `${idPrefix}-description`;\n\n  const sortedOptions = getSortedOptions({ options, contentDisplay: value });\n\n  const { activeItem, collisionDetection, handleKeyDown, sensors, setActiveItem } = useDragAndDropReorder({\n    sortedOptions,\n  });\n\n  const activeOption = activeItem ? sortedOptions.find(({ id }) => id === activeItem) : null;\n\n  const announcements = useLiveAnnouncements({\n    isDragging: activeItem !== null,\n    liveAnnouncementDndStarted: i18n(\n      'contentDisplayPreference.liveAnnouncementDndStarted',\n      liveAnnouncementDndStarted,\n      format => (position, total) => format({ position, total })\n    ),\n    liveAnnouncementDndItemReordered: i18n(\n      'contentDisplayPreference.liveAnnouncementDndItemReordered',\n      liveAnnouncementDndItemReordered,\n      format => (initialPosition, currentPosition, total) =>\n        format({ currentPosition, total, isInitialPosition: `${initialPosition === currentPosition}` })\n    ),\n    liveAnnouncementDndItemCommitted: i18n(\n      'contentDisplayPreference.liveAnnouncementDndItemCommitted',\n      liveAnnouncementDndItemCommitted,\n      format => (initialPosition, finalPosition, total) =>\n        format({ initialPosition, finalPosition, total, isInitialPosition: `${initialPosition === finalPosition}` })\n    ),\n    liveAnnouncementDndDiscarded: i18n(\n      'contentDisplayPreference.liveAnnouncementDndDiscarded',\n      liveAnnouncementDndDiscarded\n    ),\n    sortedOptions: value,\n  });\n\n  const renderedDragHandleAriaDescription = i18n(\n    'contentDisplayPreference.dragHandleAriaDescription',\n    dragHandleAriaDescription\n  );\n\n  return (\n    <div className={styles[componentPrefix]}>\n      <h3 className={getClassName('title')} id={titleId}>\n        {i18n('contentDisplayPreference.title', title)}\n      </h3>\n      <p className={getClassName('description')} id={descriptionId}>\n        {i18n('contentDisplayPreference.description', description)}\n      </p>\n      <DndContext\n        sensors={sensors}\n        collisionDetection={collisionDetection}\n        accessibility={{\n          announcements,\n          restoreFocus: false,\n          screenReaderInstructions: renderedDragHandleAriaDescription\n            ? { draggable: renderedDragHandleAriaDescription }\n            : undefined,\n        }}\n        onDragStart={({ active }) => setActiveItem(active.id)}\n        onDragEnd={event => {\n          setActiveItem(null);\n          const { active, over } = event;\n\n          if (over && active.id !== over.id) {\n            const oldIndex = value.findIndex(({ id }) => id === active.id);\n            const newIndex = value.findIndex(({ id }) => id === over.id);\n            onChange(arrayMove([...value], oldIndex, newIndex));\n          }\n        }}\n        onDragCancel={() => setActiveItem(null)}\n      >\n        {/* Use explicit list role to work around Safari not announcing lists as such when list-style is set to none.\n            See https://bugs.webkit.org/show_bug.cgi?id=170179 */}\n        <ul\n          className={getClassName('option-list')}\n          aria-describedby={descriptionId}\n          aria-labelledby={titleId}\n          role=\"list\"\n        >\n          <SortableContext items={sortedOptions.map(({ id }) => id)} strategy={verticalListSortingStrategy}>\n            {sortedOptions.map(option => {\n              return (\n                <DraggableOption\n                  dragHandleAriaLabel={i18n('contentDisplayPreference.dragHandleAriaLabel', dragHandleAriaLabel)}\n                  key={option.id}\n                  onKeyDown={handleKeyDown}\n                  onToggle={onToggle}\n                  option={option}\n                />\n              );\n            })}\n          </SortableContext>\n        </ul>\n        <Portal>\n          {/* Make sure that the drag overlay is above the modal\n              by assigning the z-index as inline style\n              so that it prevails over dnd-kit's inline z-index of 999  */}\n          {/* className is a documented prop of the DragOverlay component:\n              https://docs.dndkit.com/api-documentation/draggable/drag-overlay#class-name-and-inline-styles */\n          /* eslint-disable-next-line react/forbid-component-props */}\n          <DragOverlay className={styles['drag-overlay']} dropAnimation={null} style={{ zIndex: 5000 }}>\n            {activeOption && (\n              <ContentDisplayOption\n                listeners={{ onKeyDown: handleKeyDown }}\n                dragHandleAriaLabel={i18n('contentDisplayPreference.dragHandleAriaLabel', dragHandleAriaLabel)}\n                onToggle={onToggle}\n                option={activeOption}\n              />\n            )}\n          </DragOverlay>\n        </Portal>\n      </DndContext>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}